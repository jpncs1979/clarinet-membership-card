# シクミネットCSVで会員証を更新する手順

会員資格は**シクミネットからダウンロードしたCSV**を読み込んで反映します。

---

## 1. シクミネットでCSVをダウンロードする

1. シクミネットにログインする
2. 会員一覧やエクスポート機能から **CSVをダウンロード** する
3. ダウンロードしたファイルを、このプロジェクトの **`data` フォルダ** に保存する  
   - ファイル名は **`sikuminet.csv`** にすると、次のステップが簡単です  
   - 別の名前で保存した場合は、後述の「別のファイルを使う場合」を参照

---

## 2. CSVの列（ヘッダー）について

1行目は**列の名前（ヘッダー）**で、次のいずれかが含まれている必要があります。

| 必要な項目 | 使える列名の例 |
|------------|----------------|
| 氏名       | 氏名, 名前, name, 会員名 |
| メール     | メールアドレス, メール, email, Eメール |
| 誕生日     | 誕生日, 生年月日, birthday |

次の列は**あれば**自動で使います（なくても可）。

| 項目         | 使える列名の例 |
|--------------|----------------|
| 会員番号     | 会員番号, 会員No, member_number, 番号 |
| 支払い状況   | 支払い状況, 状態, payment_status, 会費 |
| 支払い日     | 支払い日, 入金日, payment_date |
| 有効期限     | 有効期限, 期限, expiry_date |

- **支払い状況**: 「支払済」「済」「○」「paid」→ 会員証を表示。「未払い」「未納」「×」「unpaid」→ 会員証は表示されません。
- 支払い状況の列がない場合は、**全員「支払済」**として取り込みます。
- 有効期限がない場合は、**当年の12月31日**を自動で入れます。

---

## 3. CSVを取り込む（会員データを更新する）

PowerShellで、プロジェクトのフォルダに移動してから実行します。

```powershell
cd "D:\tomoh\Documents\vsc"
node scripts/import-sikuminet-csv.js
```

- CSVが **`data/sikuminet.csv`** にある場合：上記だけでOKです。
- 「取り込み完了: ○○ 件を … に保存しました。」と出れば成功です。

### 別のファイルを使う場合

CSVのパスを指定できます。

```powershell
node scripts/import-sikuminet-csv.js "D:\ダウンロード\シクミネット会員一覧.csv"
```

---

## 4. サーバーを再起動する

取り込み後、**サーバーを一度止めてからもう一度起動**すると、新しい会員データで会員証が表示されます。

1. サーバーが動いているPowerShellで **Ctrl + C** を押して停止
2. もう一度起動する  
   ```powershell
   npm start
   ```

---

## 5. 運用の流れ（毎年・毎回の更新）

1. シクミネットで会員・会費状況を確認
2. 会員一覧をCSVでダウンロード
3. `data/sikuminet.csv` に保存（または任意のパスで保存）
4. `node scripts/import-sikuminet-csv.js`（必要ならファイルパス付き）を実行
5. サーバーを再起動（`Ctrl+C` → `npm start`）

これで「シクミネットのCSVを参照して会員資格を確認する会員証」として運用できます。

---

## サンプルCSV

列の例は **`data/sikuminet-sample.csv`** を開いて確認できます。  
シクミネットのCSVの列名が違う場合は、このサンプルを参考に列を揃えるか、`scripts/import-sikuminet-csv.js` の `COL` の部分に列名を追加できます。
