# クラリネット協会ウェブ会員証システム - セットアップガイド

## 📋 このガイドについて
プログラミングの知識がなくても、このシステムを起動して使えるように、**わかりやすく具体的な手順**を説明します。

---

## 🚀 ステップ1: Node.jsのインストール確認

### 1-1. Node.jsがインストールされているか確認
1. **Windowsキー + R** を押す
2. 「**cmd**」と入力してEnterキーを押す
3. 黒い画面（コマンドプロンプト）が開きます
4. 以下のコマンドを入力してEnterキーを押す：
   ```
   node --version
   ```
5. バージョン番号（例：v18.17.0）が表示されればOKです
6. もし「'node' は、内部コマンドまたは外部コマンド...」と表示されたら、Node.jsをインストールする必要があります

### 1-2. Node.jsのインストール（必要な場合）
1. ブラウザで https://nodejs.org/ を開く
2. 「LTS」と書かれた緑色のボタンをクリックしてダウンロード
3. ダウンロードしたファイルを実行してインストール
4. インストール中は「Next」をクリックして進む（デフォルト設定でOK）
5. インストール後、PCを再起動

---

## 📦 ステップ2: 必要なパッケージのインストール

### 2-1. プロジェクトフォルダを開く
1. エクスプローラーで `d:\tomoh\Documents\vsc` フォルダを開く
2. フォルダ内で**Shiftキーを押しながら右クリック**
3. 「**PowerShellウィンドウをここで開く**」を選択

### 2-2. パッケージをインストール
PowerShellウィンドウで以下のコマンドを入力してEnterキーを押す：
```
npm install
```

**注意**: インストールには数分かかることがあります。エラーが出た場合は、**管理者として実行**してみてください。

---

## ⚙️ ステップ3: 環境変数の設定

### 3-1. .envファイルを作成
1. `d:\tomoh\Documents\vsc` フォルダ内に `.env` という名前のファイルを作成
   - メモ帳で新規作成
   - ファイル名を `.env` にする（拡張子なし）
   - 保存場所は `d:\tomoh\Documents\vsc` フォルダ

### 3-2. .envファイルに以下を記入
```
SESSION_SECRET=clarinet-association-secret-key-2024
PORT=3000
```

**重要**: ファイル名は `.env` で、拡張子は付けません。

---

## 👥 ステップ4: 会員情報の登録

### 4-1. サンプル会員データの確認
`data/members.json` ファイルを開いて、既にサンプルデータが入っていることを確認してください。

### 4-2. 新しい会員を追加する場合
PowerShellウィンドウで以下のコマンドを実行：
```
node scripts/create-member.js
```

画面の指示に従って、以下を入力：
- 氏名
- メールアドレス
- 誕生日（YYYY-MM-DD形式、例：1990-01-15）
- 会員番号（例：CL-2024-003）
- 支払い状況（paid または unpaid）
- 支払い日（YYYY-MM-DD形式）
- 有効期限（YYYY-MM-DD形式）

---

## 🎬 ステップ5: サーバーの起動

### 5-1. サーバーを起動
PowerShellウィンドウで以下のコマンドを入力：
```
npm start
```

### 5-2. 起動確認
以下のようなメッセージが表示されれば成功です：
```
サーバーがポート 3000 で起動しました
http://localhost:3000 でアクセスできます
```

**重要**: このウィンドウは閉じないでください。閉じるとサーバーが停止します。

---

## 🌐 ステップ6: ブラウザでアクセス

### 6-1. ブラウザを開く
1. Chrome、Edge、Firefoxなどのブラウザを開く
2. アドレスバーに以下を入力：
   ```
   http://localhost:3000
   ```

### 6-2. ログイン画面が表示される
以下の画面が表示されます：
- **メールアドレス**入力欄
- **誕生日**入力欄（カレンダーから選択可能）
- **ログイン**ボタン
- **会員番号検索**セクション

---

## 🔐 ステップ7: ログインして会員証を表示

### 7-1. サンプルデータでログイン
`data/members.json` に登録されているサンプルデータでログインできます：

**会員1:**
- メールアドレス: `yamada@example.com`
- 誕生日: `1990-01-15`（任意の日付でOK、ハッシュが一致する必要があります）

**注意**: 実際の誕生日のハッシュを確認するには：
```
node scripts/hash-birthday.js 1990-01-15
```

### 7-2. 会員証の表示
ログインに成功すると、会員証ページが表示されます：
- 氏名
- 会員番号
- 有効期限
- 支払い状況

---

## 🔍 ステップ8: 会員番号検索機能の確認

### 8-1. 検索機能を使う
1. ログイン画面下部の「会員番号を検索」セクションを使用
2. 氏名を入力（例：山田）
3. 「検索」ボタンをクリック
4. 該当する会員の氏名と会員番号が表示されます

---

## 🛑 サーバーの停止方法

サーバーを停止するには：
1. PowerShellウィンドウに戻る
2. **Ctrl + C** を押す
3. 「Y」を入力してEnterキーを押す

---

## ❓ よくある問題と解決方法

### 問題1: 「npm install」でエラーが出る
**解決方法:**
- PowerShellを**管理者として実行**してから再度試す
- ウイルス対策ソフトを一時的に無効化してから試す

### 問題2: 「ポート3000が使用中」というエラー
**解決方法:**
- `.env`ファイルの`PORT=3000`を`PORT=3001`に変更
- ブラウザで`http://localhost:3001`にアクセス

### 問題3: ログインできない
**解決方法:**
- `data/members.json`の`birthdayHash`が正しいか確認
- `node scripts/hash-birthday.js YYYY-MM-DD`でハッシュを確認
- メールアドレスが完全一致しているか確認（大文字小文字は区別されません）

### 問題4: 会員証が表示されない
**解決方法:**
- ブラウザの開発者ツール（F12キー）でエラーを確認
- PowerShellウィンドウのエラーメッセージを確認

---

## 📝 次のステップ

1. **実際の会員データを登録**: `scripts/create-member.js`を使用
2. **シクミネット連携**: `scripts/sync-sikuminet.js`を編集して実装
3. **クラウドにデプロイ**: `docs/DEPLOYMENT.md`を参照

---

## 💡 ヒント

- サーバーを起動したまま、ブラウザで何度でもアクセスできます
- 会員情報を変更したら、サーバーを再起動（Ctrl+Cで停止→`npm start`で再起動）
- 開発中は`npm run dev`を使うと、ファイル変更時に自動で再起動されます
